10 REM ACIA REGISTER MONITOR
20 PRINT "ACIA STATUS MONITOR"
30 PRINT
40 REM ACIA ADDRESSES
50 AD = 33792: REM ACIA DATA $8400
60 AS = 33793: REM ACIA STATUS $8401
70 AC = 33794: REM ACIA COMMAND $8402
80 AT = 33795: REM ACIA CONTROL $8403
90 REM MAIN MENU
100 PRINT "1. READ STATUS"
110 PRINT "2. READ COMMAND"
120 PRINT "3. READ CONTROL"
130 PRINT "4. READ ALL"
140 PRINT "5. MONITOR MODE"
150 PRINT "0. EXIT"
160 PRINT
170 INPUT "CHOICE"; C
180 IF C = 0 THEN PRINT "GOODBYE": END
190 IF C = 1 THEN GOSUB 1000
200 IF C = 2 THEN GOSUB 1100
210 IF C = 3 THEN GOSUB 1200
220 IF C = 4 THEN GOSUB 1300
230 IF C = 5 THEN GOSUB 1400
240 GOTO 90
1000 REM READ STATUS REGISTER
1010 PRINT
1020 PRINT "STATUS REGISTER ($8401)"
1030 V = PEEK(AS)
1040 PRINT "VALUE: "; V; " = $";
1050 GOSUB 3000
1060 PRINT " = ";
1070 GOSUB 3100
1080 PRINT
1090 PRINT "BIT 7 (IRQ):     "; : IF V >= 128 THEN PRINT "IRQ ACTIVE" : V = V - 128: GOTO 1100
1095 PRINT "NO IRQ"
1100 PRINT "BIT 6 (DSR):     "; : IF V >= 64 THEN PRINT "DSR HIGH" : V = V - 64: GOTO 1110
1105 PRINT "DSR LOW"
1110 PRINT "BIT 5 (DCD):     "; : IF V >= 32 THEN PRINT "DCD HIGH" : V = V - 32: GOTO 1120
1115 PRINT "DCD LOW"
1120 PRINT "BIT 4 (TX EMPT): "; : IF V >= 16 THEN PRINT "TX EMPTY" : V = V - 16: GOTO 1130
1125 PRINT "TX BUSY"
1130 PRINT "BIT 3 (RX FULL): "; : IF V >= 8 THEN PRINT "RX FULL" : V = V - 8: GOTO 1140
1135 PRINT "RX EMPTY"
1140 PRINT "BIT 2 (OVERRUN): "; : IF V >= 4 THEN PRINT "OVERRUN!" : V = V - 4: GOTO 1150
1145 PRINT "OK"
1150 PRINT "BIT 1 (FRAMING):"; : IF V >= 2 THEN PRINT "ERROR!" : V = V - 2: GOTO 1160
1155 PRINT "OK"
1160 PRINT "BIT 0 (PARITY): "; : IF V >= 1 THEN PRINT "ERROR!": GOTO 1170
1165 PRINT "OK"
1170 PRINT
1180 INPUT "PRESS ENTER"; A$
1190 RETURN
1100 REM READ COMMAND REGISTER
1110 PRINT
1120 PRINT "COMMAND REGISTER ($8402)"
1130 V = PEEK(AC)
1140 PRINT "VALUE: "; V; " = $";
1150 GOSUB 3000
1160 PRINT " = ";
1170 GOSUB 3100
1180 PRINT
1190 PRINT "BIT 7-5 (PARITY):"
1200 P = INT(V / 32)
1210 IF P = 0 THEN PRINT "  ODD PARITY, TX=1, RX=EN"
1220 IF P = 1 THEN PRINT "  EVEN PARITY, TX=0, RX=EN"
1230 IF P = 2 THEN PRINT "  ODD PARITY, TX=1, RX=DIS"
1240 IF P = 3 THEN PRINT "  EVEN PARITY, TX=0, RX=DIS"
1250 IF P = 4 THEN PRINT "  NO PARITY, TX=1, RX=DIS"
1260 IF P = 5 THEN PRINT "  NO PARITY, TX=0, RX=DIS"
1270 IF P = 6 THEN PRINT "  NO PARITY, TX=1, RX=DIS"
1280 IF P = 7 THEN PRINT "  NO PARITY, TX=0, RX=DIS"
1290 V = V - P * 32
1300 PRINT "BIT 4 (ECHO):    "; : IF V >= 16 THEN PRINT "NORMAL" : V = V - 16: GOTO 1310
1305 PRINT "ECHO MODE"
1310 PRINT "BIT 3-2 (TX/RTS):"
1320 T = INT(V / 4)
1330 IF T = 0 THEN PRINT "  RTS=LOW, TX IRQ DIS"
1340 IF T = 1 THEN PRINT "  RTS=LOW, TX IRQ EN"
1350 IF T = 2 THEN PRINT "  RTS=HIGH, TX IRQ DIS"
1360 IF T = 3 THEN PRINT "  RTS=LOW, TX BRK, IRQ DIS"
1370 V = V - T * 4
1380 PRINT "BIT 1 (RX IRQ):  "; : IF V >= 2 THEN PRINT "DISABLED" : V = V - 2: GOTO 1390
1385 PRINT "ENABLED"
1390 PRINT "BIT 0 (DTR):     "; : IF V >= 1 THEN PRINT "DTR HIGH": GOTO 1400
1395 PRINT "DTR LOW"
1400 PRINT
1410 INPUT "PRESS ENTER"; A$
1420 RETURN
1200 REM READ CONTROL REGISTER
1210 PRINT
1220 PRINT "CONTROL REGISTER ($8403)"
1230 V = PEEK(AT)
1240 PRINT "VALUE: "; V; " = $";
1250 GOSUB 3000
1260 PRINT " = ";
1270 GOSUB 3100
1280 PRINT
1290 PRINT "BIT 7 (STOP):    "; : IF V >= 128 THEN PRINT "1 STOP BIT" : V = V - 128: GOTO 1300
1295 PRINT "2 STOP BITS"
1300 PRINT "BIT 6-5 (WORD):"
1310 W = INT(V / 32)
1320 IF W = 0 THEN PRINT "  8 BITS"
1330 IF W = 1 THEN PRINT "  7 BITS"
1340 IF W = 2 THEN PRINT "  6 BITS"
1350 IF W = 3 THEN PRINT "  5 BITS"
1360 V = V - W * 32
1370 PRINT "BIT 4 (RX CLK):  "; : IF V >= 16 THEN PRINT "EXTERNAL" : V = V - 16: GOTO 1380
1375 PRINT "INTERNAL"
1380 PRINT "BIT 3-0 (BAUD):"
1390 B = V
1400 IF B = 0 THEN PRINT "  16X EXT CLOCK"
1410 IF B = 1 THEN PRINT "  50 BAUD"
1420 IF B = 2 THEN PRINT "  75 BAUD"
1430 IF B = 3 THEN PRINT "  110 BAUD"
1440 IF B = 4 THEN PRINT "  135 BAUD"
1450 IF B = 5 THEN PRINT "  150 BAUD"
1460 IF B = 6 THEN PRINT "  300 BAUD"
1470 IF B = 7 THEN PRINT "  600 BAUD"
1480 IF B = 8 THEN PRINT "  1200 BAUD"
1490 IF B = 9 THEN PRINT "  1800 BAUD"
1500 IF B = 10 THEN PRINT "  2400 BAUD"
1510 IF B = 11 THEN PRINT "  3600 BAUD"
1520 IF B = 12 THEN PRINT "  4800 BAUD"
1530 IF B = 13 THEN PRINT "  7200 BAUD"
1540 IF B = 14 THEN PRINT "  9600 BAUD"
1550 IF B = 15 THEN PRINT "  19200 BAUD"
1560 PRINT
1570 INPUT "PRESS ENTER"; A$
1580 RETURN
1300 REM READ ALL REGISTERS
1310 PRINT
1320 PRINT "ALL ACIA REGISTERS"
1330 PRINT "===================="
1340 V = PEEK(AS)
1350 PRINT "STATUS:  "; V; " = $";
1360 GOSUB 3000
1370 PRINT " = ";
1380 GOSUB 3100
1390 PRINT
1400 V = PEEK(AC)
1410 PRINT "COMMAND: "; V; " = $";
1420 GOSUB 3000
1430 PRINT " = ";
1440 GOSUB 3100
1450 PRINT
1460 V = PEEK(AT)
1470 PRINT "CONTROL: "; V; " = $";
1480 GOSUB 3000
1490 PRINT " = ";
1500 GOSUB 3100
1510 PRINT
1520 INPUT "PRESS ENTER"; A$
1530 RETURN
1400 REM MONITOR MODE
1410 PRINT
1420 PRINT "MONITOR MODE"
1430 PRINT "ENTER LOOPS (1-1000)"
1440 INPUT "COUNT"; LC
1450 IF LC < 1 OR LC > 1000 THEN LC = 100
1460 PRINT
1470 FOR L = 1 TO LC
1480 PRINT "STATUS:  ";
1490 V = PEEK(AS): GOSUB 3000
1500 PRINT " CMD: ";
1510 V = PEEK(AC): GOSUB 3000
1520 PRINT " CTL: ";
1530 V = PEEK(AT): GOSUB 3000
1540 PRINT
1550 FOR D = 1 TO 50: NEXT D
1560 NEXT L
1570 RETURN
3000 REM PRINT HEX
3010 H = INT(V / 16)
3020 IF H < 10 THEN PRINT CHR$(48 + H);
3030 IF H >= 10 THEN PRINT CHR$(55 + H);
3040 H = V - INT(V / 16) * 16
3050 IF H < 10 THEN PRINT CHR$(48 + H);
3060 IF H >= 10 THEN PRINT CHR$(55 + H);
3070 RETURN
3100 REM PRINT BINARY
3110 FOR I = 7 TO 0 STEP -1
3120 M = 2 ^ I
3130 IF V >= M THEN PRINT "1 ";: V = V - M: GOTO 3160
3150 PRINT "0 ";
3160 NEXT I
3170 RETURN
