10 REM SIEVE OF ERATOSTHENES - CPU STRESS TEST
20 REM FINDS ALL PRIME NUMBERS UP TO N
30 PRINT "PRIME SIEVE BENCHMARK"
40 PRINT
50 PRINT "FIND PRIMES UP TO:";
60 INPUT N
70 IF N < 2 OR N > 5000 THEN GOTO 50
80 PRINT
90 PRINT "INITIALIZING..."
100 REM Initialize array - 1=prime, 0=composite
110 DIM P(N)
120 FOR I = 2 TO N
130 P(I) = 1
140 NEXT I
150 PRINT "SIEVING..."
160 T = 0
170 REM Start sieve algorithm
180 FOR I = 2 TO INT(SQR(N))
190 IF P(I) = 0 THEN GOTO 260
200 REM Mark multiples as composite
210 FOR J = I * I TO N STEP I
220 P(J) = 0
230 NEXT J
240 T = T + 1
250 IF T MOD 10 = 0 THEN PRINT ".";
260 NEXT I
270 PRINT
280 PRINT "COUNTING PRIMES..."
290 C = 0
300 FOR I = 2 TO N
310 IF P(I) = 1 THEN C = C + 1
320 NEXT I
330 PRINT
340 PRINT "FOUND "; C; " PRIMES UP TO "; N
350 PRINT
360 PRINT "SHOW PRIMES (Y/N)";
370 INPUT A$
380 IF A$ <> "Y" THEN GOTO 480
390 PRINT
400 L = 0
410 FOR I = 2 TO N
420 IF P(I) = 0 THEN GOTO 460
430 PRINT I;
440 L = L + 1
450 IF L MOD 10 = 0 THEN PRINT
460 NEXT I
470 PRINT
480 PRINT
490 PRINT "RUN AGAIN (Y/N)";
500 INPUT A$
510 IF A$ = "Y" THEN GOTO 30
520 END
